<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>8 Times Tables - Fun Activities</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            font-family: 'Comic Sans MS', 'Arial Rounded MT Bold', cursive;
        }

        .container {
            max-width: 1100px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            color: white;
            margin-bottom: 20px;
        }

        .header h1 {
            font-size: 2.8em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }

        .header p {
            font-size: 1.1em;
        }

        /* Tips card for Double-Double-Double & Pattern */
        .tips-card {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }

        .tips-title {
            font-size: 1.5em;
            color: #667eea;
            margin-bottom: 10px;
            font-weight: bold;
        }

        .tips-section-title {
            font-size: 1.2em;
            color: #764ba2;
            margin-top: 10px;
            margin-bottom: 5px;
            font-weight: bold;
        }

        .tips-text {
            color: #444;
            line-height: 1.6;
            font-size: 0.98em;
        }

        .double-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
            margin-bottom: 10px;
            font-size: 0.95em;
        }

        .double-table th,
        .double-table td {
            border: 1px solid #ddd;
            padding: 6px 8px;
            text-align: center;
        }

        .double-table th {
            background: #eef;
            color: #333;
        }

        .sequence {
            margin-top: 8px;
            margin-bottom: 5px;
            font-weight: bold;
        }

        .tens {
            color: #0066cc;
            font-weight: bold;
        }

        .ones {
            color: #cc0000;
            font-weight: bold;
        }

        .activities-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .activity-card {
            background: white;
            border-radius: 20px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            cursor: pointer;
            transition: all 0.3s ease;
            border: 3px solid transparent;
        }

        .activity-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.3);
        }

        .activity-card.active {
            border-color: #667eea;
            background: #f5f5f5;
        }

        .activity-icon {
            font-size: 3em;
            margin-bottom: 10px;
        }

        .activity-title {
            font-size: 1.4em;
            color: #667eea;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .activity-description {
            color: #666;
            font-size: 0.95em;
            line-height: 1.6;
        }

        .activity-content {
            display: none;
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            margin-bottom: 20px;
        }

        .activity-content.active {
            display: block;
        }

        .activity-content h2 {
            color: #667eea;
            margin-bottom: 20px;
            font-size: 2em;
        }

        .back-button {
            background: #667eea;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 1em;
            margin-bottom: 20px;
            font-family: 'Comic Sans MS', cursive;
            font-weight: bold;
        }

        .back-button:hover {
            background: #764ba2;
        }

        /* Activity 1: Multiple Choice */
        .quiz-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 10px;
            margin: 20px 0;
        }

        .quiz-option {
            padding: 15px;
            border: 2px solid #ddd;
            border-radius: 10px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1.1em;
            font-weight: bold;
        }

        .quiz-option:hover {
            border-color: #667eea;
            background: #f5f5f5;
        }

        .quiz-option.correct {
            background: #c8e6c9;
            border-color: #4caf50;
            color: #2e7d32;
        }

        .quiz-option.incorrect {
            background: #ffcdd2;
            border-color: #f44336;
            color: #c62828;
        }

        .question-text {
            font-size: 1.4em;
            color: #333;
            margin-bottom: 20px;
            font-weight: bold;
        }

        /* Activity 2: Fill in blanks */
        .blank-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .blank-item {
            background: #f5f5f5;
            padding: 15px;
            border-radius: 10px;
            border: 2px solid transparent;
        }

        .blank-problem {
            font-size: 1.2em;
            color: #333;
            margin-bottom: 10px;
            font-weight: bold;
        }

        .blank-input {
            width: 100%;
            padding: 10px;
            border: 2px solid #667eea;
            border-radius: 8px;
            font-size: 1em;
            text-align: center;
        }

        /* Activity 3: Word Problems */
        .story-problem {
            background: #f5f5f5;
            padding: 20px;
            border-radius: 10px;
            margin: 15px 0;
            border-left: 5px solid #667eea;
        }

        .story-text {
            font-size: 1.1em;
            color: #333;
            margin-bottom: 15px;
            line-height: 1.8;
        }

        .story-input {
            padding: 10px;
            border: 2px solid #667eea;
            border-radius: 8px;
            font-size: 1em;
            width: 150px;
            text-align: center;
        }

        /* Activity 4: Matching */
        .matching-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 20px 0;
        }

        .matching-column {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .matching-item {
            background: #f5f5f5;
            padding: 15px;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }

        .matching-item:hover {
            border-color: #667eea;
            background: #fff9e6;
        }

        .matching-item.matched {
            background: #c8e6c9;
            border-color: #4caf50;
            cursor: default;
        }

        .matching-item.selected {
            border-color: #ff9800;
            background: #fff3cd;
        }

        /* Activity 5: Patterns */
        .pattern-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
            gap: 10px;
            margin: 20px 0;
        }

        .pattern-box {
            aspect-ratio: 1;
            background: #f5f5f5;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.3em;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }

        .pattern-box:hover {
            transform: scale(1.05);
            border-color: #667eea;
        }

        .pattern-box.revealed {
            background: #667eea;
            color: white;
        }

        /* Activity 6: Speed Challenge */
        .speed-challenge {
            text-align: center;
        }

        .speed-question {
            font-size: 2em;
            color: #667eea;
            margin: 20px 0;
            font-weight: bold;
        }

        .speed-input {
            font-size: 1.3em;
            padding: 12px;
            border: 3px solid #667eea;
            border-radius: 10px;
            width: 150px;
            text-align: center;
            margin: 20px 0;
        }

        .timer {
            font-size: 1.5em;
            color: #f44336;
            font-weight: bold;
            margin: 15px 0;
        }

        .score-display {
            background: #f5f5f5;
            padding: 15px;
            border-radius: 10px;
            font-size: 1.2em;
            margin: 15px 0;
        }

        button {
            background: #667eea;
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 25px;
            font-size: 1.1em;
            cursor: pointer;
            transition: all 0.3s ease;
            font-family: 'Comic Sans MS', cursive;
            font-weight: bold;
            margin: 10px;
        }

        button:hover:not(:disabled) {
            background: #764ba2;
            transform: scale(1.05);
        }

        button:disabled {
            background: #ccc;
            cursor: not-allowed;
        }

        .feedback {
            font-size: 1.2em;
            margin: 15px 0;
            min-height: 30px;
            text-align: center;
        }

        .correct {
            color: #4caf50;
            font-weight: bold;
        }

        .incorrect {
            color: #f44336;
            font-weight: bold;
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 2em;
            }

            .matching-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <h1>üéÆ 8 Times Tables - Fun Activities!</h1>
            <p>Let‚Äôs learn 8 as ‚ÄúDouble, Double, Double‚Äù and find the secret pattern! ‚ú®</p>
        </div>

        <!-- Tips: Double Double Double & Pattern -->
        <div class="tips-card">
            <div class="tips-title">‚≠ê 8 is ‚ÄúDouble, Double, Double‚Äù</div>
            <div class="tips-text">
                Tell your child: <strong>8 means doubling three times!</strong>
                Start with any number, then:
                <em>Double ‚Üí Double ‚Üí Double again</em>.
            </div>

            <table class="double-table">
                <tr>
                    <th>Number</th>
                    <th>Double</th>
                    <th>Double Again</th>
                    <th>Double Again</th>
                </tr>
                <tr>
                    <td>2</td>
                    <td>4</td>
                    <td>8</td>
                    <td>16</td>
                </tr>
                <tr>
                    <td>3</td>
                    <td>6</td>
                    <td>12</td>
                    <td>24</td>
                </tr>
                <tr>
                    <td>4</td>
                    <td>8</td>
                    <td>16</td>
                    <td>32</td>
                </tr>
            </table>

            <div class="tips-text">
                So:<br>
                <strong>8 √ó 4</strong> = (4 ‚Üí 8 ‚Üí 16 ‚Üí <strong>32</strong>)<br>
                <strong>8 √ó 6</strong> = (6 ‚Üí 12 ‚Üí 24 ‚Üí <strong>48</strong>)<br><br>
                Make it a little chant with actions:<br>
                ‚ÄúDouble!‚Äù ‚ûú ‚ÄúDouble!‚Äù ‚ûú ‚ÄúDouble again!‚Äù üôå
            </div>

            <div class="tips-section-title">üîç Pattern in the 8 Times Table</div>
            <div class="tips-text">
                Look at the answers: <br>
                <div class="sequence">
                    8, 16, 24, 32, 40, 48, 56, 64, 72, 80
                </div>
                Ask:
                <ul style="margin-left:20px; margin-top:5px;">
                    <li><strong>What happens to the ones digit?</strong> ‚Üí 8 ‚Üí 6 ‚Üí 4 ‚Üí 2 ‚Üí 0 ‚Üí 8 ‚Üí 6 ‚Üí ...</li>
                    <li><strong>What happens to the tens digit?</strong> ‚Üí goes up by 1 every two numbers</li>
                </ul>
                In the pattern game below, the <span class="tens">tens digit is blue</span> and the
                <span class="ones">ones digit is red</span> to make the pattern pop! üé®
            </div>
        </div>

        <!-- Activity Selection -->
        <div class="activities-grid">
            <div class="activity-card" onclick="openActivity('multipleChoice')">
                <div class="activity-icon">üéØ</div>
                <div class="activity-title">Multiple Choice</div>
                <div class="activity-description">Pick the correct 8√ó answer from options!</div>
            </div>

            <div class="activity-card" onclick="openActivity('fillBlanks')">
                <div class="activity-icon">üìù</div>
                <div class="activity-title">Fill in the Blanks</div>
                <div class="activity-description">Complete the 8 times table problems!</div>
            </div>

            <div class="activity-card" onclick="openActivity('wordProblems')">
                <div class="activity-icon">üìñ</div>
                <div class="activity-title">Word Problems</div>
                <div class="activity-description">Solve fun real-life problems with 8√ó!</div>
            </div>

            <div class="activity-card" onclick="openActivity('matching')">
                <div class="activity-icon">üîó</div>
                <div class="activity-title">Match Problems & Answers</div>
                <div class="activity-description">Connect the 8√ó questions to their answers!</div>
            </div>

            <div class="activity-card" onclick="openActivity('patterns')">
                <div class="activity-icon">üîç</div>
                <div class="activity-title">Find the Pattern</div>
                <div class="activity-description">Click to reveal the colored 8√ó pattern!</div>
            </div>

            <div class="activity-card" onclick="openActivity('speedChallenge')">
                <div class="activity-icon">‚ö°</div>
                <div class="activity-title">Speed Challenge</div>
                <div class="activity-description">Beat the clock with 8√ó facts!</div>
            </div>
        </div>

        <!-- Activity 1: Multiple Choice -->
        <div class="activity-content" id="multipleChoice">
            <button class="back-button" onclick="closeActivity()">‚Üê Back to Activities</button>
            <h2>üéØ Multiple Choice Quiz</h2>
            <div class="question-text" id="mcQuestion">8 √ó 1 = ?</div>
            <div class="quiz-grid" id="mcOptions"></div>
            <div class="feedback" id="mcFeedback"></div>
            <button onclick="nextMC()">Next Question ‚Üí</button>
        </div>

        <!-- Activity 2: Fill in Blanks -->
        <div class="activity-content" id="fillBlanks">
            <button class="back-button" onclick="closeActivity()">‚Üê Back to Activities</button>
            <h2>üìù Fill in the Blanks</h2>
            <p style="color: #666; margin-bottom: 20px;">Type the answer for each 8√ó problem:</p>
            <div class="blank-grid" id="blankGrid"></div>
            <button onclick="checkBlanks()">‚úì Check Answers</button>
            <div class="feedback" id="blankFeedback"></div>
        </div>

        <!-- Activity 3: Word Problems -->
        <div class="activity-content" id="wordProblems">
            <button class="back-button" onclick="closeActivity()">‚Üê Back to Activities</button>
            <h2>üìñ Word Problems</h2>
            <div id="storyContainer"></div>
            <button onclick="nextStory()">Next Story ‚Üí</button>
        </div>

        <!-- Activity 4: Matching -->
        <div class="activity-content" id="matching">
            <button class="back-button" onclick="closeActivity()">‚Üê Back to Activities</button>
            <h2>üîó Match Problems & Answers</h2>
            <p style="color: #666; margin-bottom: 20px;">Click to match each 8√ó question with the correct answer!</p>
            <div class="matching-grid">
                <div>
                    <h3 style="color: #667eea; margin-bottom: 15px;">Problems</h3>
                    <div class="matching-column" id="problemsColumn"></div>
                </div>
                <div>
                    <h3 style="color: #667eea; margin-bottom: 15px;">Answers</h3>
                    <div class="matching-column" id="answersColumn"></div>
                </div>
            </div>
            <div class="feedback" id="matchingFeedback"></div>
        </div>

        <!-- Activity 5: Patterns -->
        <div class="activity-content" id="patterns">
            <button class="back-button" onclick="closeActivity()">‚Üê Back to Activities</button>
            <h2>üîç Find the Pattern</h2>
            <p style="color: #666; margin-bottom: 20px;">
                Click each box to reveal an answer from the 8 times table.
                Watch the <span class="tens">blue tens</span> and <span class="ones">red ones</span> digits!
            </p>
            <div class="pattern-grid" id="patternGrid"></div>
            <button onclick="revealAll()">Show All</button>
        </div>

        <!-- Activity 6: Speed Challenge -->
        <div class="activity-content" id="speedChallenge">
            <button class="back-button" onclick="closeActivity()">‚Üê Back to Activities</button>
            <h2>‚ö° Speed Challenge</h2>
            <div class="speed-challenge">
                <div class="timer" id="timerDisplay">Time: 60s</div>
                <div class="speed-question" id="speedQuestion">8 √ó 1 = ?</div>
                <input type="number" class="speed-input" id="speedInput" placeholder="Answer" onkeypress="if(event.key === 'Enter') submitSpeed();">
                <br>
                <button onclick="startSpeed()" id="startSpeedBtn">üöÄ Start Challenge!</button>
                <button onclick="submitSpeed()" id="submitSpeedBtn" style="display: none;">Submit</button>
                <div class="score-display" id="speedScore"></div>
            </div>
        </div>
    </div>

    <script>
        // 8 times table 1‚Äì10
        const problems = [
            { num: 1, answer: 8 },
            { num: 2, answer: 16 },
            { num: 3, answer: 24 },
            { num: 4, answer: 32 },
            { num: 5, answer: 40 },
            { num: 6, answer: 48 },
            { num: 7, answer: 56 },
            { num: 8, answer: 64 },
            { num: 9, answer: 72 },
            { num: 10, answer: 80 }
        ];

        // Simple 8√ó word problems
        const stories = [
            {
                text: "üçé Mia has 8 baskets. Each basket has 3 apples. How many apples does she have in total?",
                problem: "8 √ó 3",
                answer: 24
            },
            {
                text: "üéà There are 8 children. Each child gets 4 balloons. How many balloons in total?",
                problem: "8 √ó 4",
                answer: 32
            },
            {
                text: "üöó A parking lot has 5 rows. Each row has 8 cars. How many cars?",
                problem: "5 √ó 8",
                answer: 40
            },
            {
                text: "üçï A pizza shop has 8 boxes. Each box has 6 slices of pizza. How many slices?",
                problem: "8 √ó 6",
                answer: 48
            },
            {
                text: "üìö A classroom has 8 shelves. Each shelf holds 9 books. How many books?",
                problem: "8 √ó 9",
                answer: 72
            }
        ];

        let currentMC = 0;
        let currentStory = 0;
        let speedActive = false;
        let speedTime = 60;
        let speedScore = 0;
        let speedCorrect = 0;

        // Matching state
        let selectedProblem = null;
        let selectedAnswer = null;
        let matchedCount = 0;

        function openActivity(activity) {
            document.querySelectorAll('.activity-content').forEach(el => el.classList.remove('active'));
            document.getElementById(activity).classList.add('active');

            if (activity === 'multipleChoice') initMC();
            if (activity === 'fillBlanks') initBlanks();
            if (activity === 'wordProblems') initStory();
            if (activity === 'matching') initMatching();
            if (activity === 'patterns') initPatterns();
        }

        function closeActivity() {
            document.querySelectorAll('.activity-content').forEach(el => el.classList.remove('active'));
            speedActive = false;
        }

        // Multiple Choice
        function initMC() {
            currentMC = Math.floor(Math.random() * problems.length);
            displayMC();
        }

        function displayMC() {
            const problem = problems[currentMC];
            document.getElementById('mcQuestion').textContent = `8 √ó ${problem.num} = ?`;

            const options = [problem.answer];
            while (options.length < 4) {
                const wrong = Math.floor(Math.random() * 80) + 1; // 1‚Äì80
                if (!options.includes(wrong)) options.push(wrong);
            }
            options.sort(() => Math.random() - 0.5);

            const grid = document.getElementById('mcOptions');
            grid.innerHTML = '';
            options.forEach(option => {
                const btn = document.createElement('button');
                btn.className = 'quiz-option';
                btn.textContent = option;
                btn.onclick = () => checkMC(option, problem.answer);
                grid.appendChild(btn);
            });

            document.getElementById('mcFeedback').textContent = '';
        }

        function checkMC(selected, correct) {
            const feedback = document.getElementById('mcFeedback');
            if (selected === correct) {
                feedback.innerHTML = `<span class="correct">‚úì Correct! ${correct} is right!</span>`;
            } else {
                feedback.innerHTML = `<span class="incorrect">‚úó Not quite! The answer is ${correct}</span>`;
            }
        }

        function nextMC() {
            initMC();
        }

        // Fill in Blanks
        function initBlanks() {
            const grid = document.getElementById('blankGrid');
            grid.innerHTML = '';
            problems.forEach(problem => {
                const item = document.createElement('div');
                item.className = 'blank-item';
                item.innerHTML = `
                    <div class="blank-problem">8 √ó ${problem.num} = </div>
                    <input type="number" class="blank-input" placeholder="?" data-answer="${problem.answer}">
                `;
                grid.appendChild(item);
            });
        }

        function checkBlanks() {
            const inputs = document.querySelectorAll('.blank-input');
            let correct = 0;
            inputs.forEach(input => {
                const answer = parseInt(input.value);
                const correctAnswer = parseInt(input.dataset.answer);
                if (answer === correctAnswer) {
                    input.style.borderColor = '#4caf50';
                    correct++;
                } else {
                    input.style.borderColor = '#f44336';
                }
            });
            document.getElementById('blankFeedback').innerHTML =
                `<span class="correct">‚úì ${correct}/${inputs.length} correct!</span>`;
        }

        // Word Problems
        function initStory() {
            currentStory = Math.floor(Math.random() * stories.length);
            displayStory();
        }

        function displayStory() {
            const story = stories[currentStory];
            const container = document.getElementById('storyContainer');
            container.innerHTML = `
                <div class="story-problem">
                    <div class="story-text">${story.text}</div>
                    <p style="color: #666; margin-bottom: 10px;"><strong>Problem: ${story.problem}</strong></p>
                    <input type="number" class="story-input" id="storyInput" placeholder="Answer">
                    <button onclick="checkStory()">Check Answer</button>
                    <div class="feedback" id="storyFeedback"></div>
                </div>
            `;
            document.getElementById('storyInput').focus();
        }

        function checkStory() {
            const answer = parseInt(document.getElementById('storyInput').value);
            const story = stories[currentStory];
            const feedback = document.getElementById('storyFeedback');
            if (answer === story.answer) {
                feedback.innerHTML = `<span class="correct">‚úì Correct! The answer is ${story.answer}!</span>`;
            } else {
                feedback.innerHTML = `<span class="incorrect">‚úó Not quite. The answer is ${story.answer}</span>`;
            }
        }

        function nextStory() {
            initStory();
        }

        // Matching
        function initMatching() {
            const problemsList = [...problems].sort(() => Math.random() - 0.5);
            const answersList = [...problems].sort(() => Math.random() - 0.5);

            const pColumn = document.getElementById('problemsColumn');
            const aColumn = document.getElementById('answersColumn');
            pColumn.innerHTML = '';
            aColumn.innerHTML = '';

            selectedProblem = null;
            selectedAnswer = null;
            matchedCount = 0;
            document.getElementById('matchingFeedback').textContent = '';

            problemsList.forEach(p => {
                const div = document.createElement('div');
                div.className = 'matching-item';
                div.textContent = `8 √ó ${p.num}`;
                div.dataset.answer = p.answer;
                div.onclick = () => selectProblem(div);
                pColumn.appendChild(div);
            });

            answersList.forEach(p => {
                const div = document.createElement('div');
                div.className = 'matching-item';
                div.textContent = p.answer;
                div.dataset.answer = p.answer;
                div.onclick = () => selectAnswer(div);
                aColumn.appendChild(div);
            });
        }

        function selectProblem(el) {
            if (el.classList.contains('matched')) return;
            if (selectedProblem) selectedProblem.classList.remove('selected');
            selectedProblem = el;
            el.classList.add('selected');

            if (selectedAnswer) {
                checkMatch();
            }
        }

        function selectAnswer(el) {
            if (el.classList.contains('matched')) return;
            if (selectedAnswer) selectedAnswer.classList.remove('selected');
            selectedAnswer = el;
            el.classList.add('selected');

            if (selectedProblem) {
                checkMatch();
            }
        }

        function checkMatch() {
            const feedback = document.getElementById('matchingFeedback');
            const problemAnswer = parseInt(selectedProblem.dataset.answer);
            const answerValue = parseInt(selectedAnswer.dataset.answer);

            if (problemAnswer === answerValue) {
                selectedProblem.classList.remove('selected');
                selectedAnswer.classList.remove('selected');

                selectedProblem.classList.add('matched');
                selectedAnswer.classList.add('matched');

                selectedProblem.onclick = null;
                selectedAnswer.onclick = null;

                matchedCount++;
                feedback.innerHTML = `<span class="correct">‚úì Nice match!</span>`;

                selectedProblem = null;
                selectedAnswer = null;

                if (matchedCount === problems.length) {
                    feedback.innerHTML = `<span class="correct">üèÜ You matched all of them! Great job!</span>`;
                }
            } else {
                feedback.innerHTML = `<span class="incorrect">‚úó Not a match. Try again!</span>`;
                setTimeout(() => {
                    if (selectedProblem) selectedProblem.classList.remove('selected');
                    if (selectedAnswer) selectedAnswer.classList.remove('selected');
                    selectedProblem = null;
                    selectedAnswer = null;
                }, 400);
            }
        }

        // Patterns ‚Äì color tens (blue) and ones (red)
        function initPatterns() {
            const grid = document.getElementById('patternGrid');
            grid.innerHTML = '';
            problems.forEach((p) => {
                const box = document.createElement('div');
                box.className = 'pattern-box';
                box.textContent = '?';
                box.onclick = () => revealPatternBox(box, p.answer);
                grid.appendChild(box);
            });
        }

        function revealPatternBox(box, value) {
            const str = value.toString();
            let html;
            if (str.length === 1) {
                // Just ones digit (e.g., 8)
                html = `<span class="ones">${str}</span>`;
            } else {
                html = `<span class="tens">${str[0]}</span><span class="ones">${str[1]}</span>`;
            }
            box.classList.add('revealed');
            box.innerHTML = html;
        }

        function revealAll() {
            const boxes = document.querySelectorAll('.pattern-box');
            boxes.forEach((box, idx) => {
                const value = problems[idx].answer;
                revealPatternBox(box, value);
            });
        }

        // Speed Challenge
        function startSpeed() {
            speedActive = true;
            speedTime = 60;
            speedScore = 0;
            speedCorrect = 0;
            document.getElementById('startSpeedBtn').style.display = 'none';
            document.getElementById('submitSpeedBtn').style.display = 'inline-block';
            document.getElementById('speedInput').disabled = false;
            document.getElementById('speedInput').value = '';
            document.getElementById('speedInput').focus();

            nextSpeedQuestion();

            const timer = setInterval(() => {
                speedTime--;
                document.getElementById('timerDisplay').textContent = `Time: ${speedTime}s`;
                if (speedTime <= 0) {
                    clearInterval(timer);
                    endSpeed();
                }
            }, 1000);
        }

        function nextSpeedQuestion() {
            const p = problems[Math.floor(Math.random() * problems.length)];
            document.getElementById('speedQuestion').textContent = `8 √ó ${p.num} = ?`;
            document.getElementById('speedQuestion').dataset.answer = p.answer;
            document.getElementById('speedInput').value = '';
            document.getElementById('speedInput').focus();
        }

        function submitSpeed() {
            if (!speedActive) return;

            const answer = parseInt(document.getElementById('speedInput').value);
            const correct = parseInt(document.getElementById('speedQuestion').dataset.answer);

            if (answer === correct) {
                speedCorrect++;
            }
            speedScore++;
            nextSpeedQuestion();
        }

        function endSpeed() {
            speedActive = false;
            document.getElementById('submitSpeedBtn').style.display = 'none';
            document.getElementById('startSpeedBtn').style.display = 'inline-block';
            document.getElementById('speedInput').disabled = true;

            if (speedScore === 0) {
                document.getElementById('speedScore').innerHTML =
                    `‚è±Ô∏è <strong>No answers submitted this round.</strong><br>Try again!`;
                return;
            }

            const percent = Math.round((speedCorrect / speedScore) * 100);
            let emoji = 'üéñÔ∏è';
            if (percent === 100) emoji = 'üèÜ';
            else if (percent >= 80) emoji = 'ü•á';
            else if (percent >= 60) emoji = 'ü•à';

            document.getElementById('speedScore').innerHTML =
                `${emoji} <strong>Score: ${speedCorrect}/${speedScore} (${percent}%)</strong><br>Great effort! Try again!`;
        }
    </script>
</body>
</html>
