
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>CIFAR-10 CNN Architecture Visualizer</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      background: linear-gradient(135deg, #1a1d1f 0%, #2a1e28 100%);
      font-family: 'Roboto', Arial, sans-serif;
      color: #ffb3de;
      min-height: 100vh;
      padding: 20px;
    }

    .container {
      max-width: 1600px;
      margin: 0 auto;
      background: #222025;
      border-radius: 18px;
      padding: 40px;
      box-shadow: 0 4px 30px rgba(255, 121, 198, 0.15);
      border-left: 7px solid #ff79c6;
    }

    h1 {
      color: #ff79c6;
      text-align: center;
      margin-bottom: 10px;
      font-size: 2.2em;
    }

    .subtitle {
      text-align: center;
      color: #ffb3de;
      margin-bottom: 30px;
      font-size: 1.1em;
    }

    .cifar-intro {
      background: #19121a;
      border-radius: 10px;
      padding: 18px 20px;
      margin-bottom: 25px;
      line-height: 1.7;
      font-size: 0.95em;
      border-left: 4px solid #50fa7b;
    }

    .cifar-intro strong {
      color: #fff52e;
    }

    .controls {
      background: #2a1e28;
      border: 2px solid #ff79c6;
      border-radius: 12px;
      padding: 25px;
      margin-bottom: 30px;
      display: flex;
      gap: 20px;
      flex-wrap: wrap;
      align-items: flex-start;
    }

    .control-group {
      display: flex;
      flex-direction: column;
      gap: 6px;
      min-width: 220px;
    }

    .control-group label {
      color: #ff79c6;
      font-weight: 600;
      font-size: 0.95em;
    }

    .control-group span {
      font-size: 0.9em;
      color: #ffb3de;
      line-height: 1.5;
    }

    .network-container {
      background: #2a1e28;
      border: 2px solid #ff79c6;
      border-radius: 12px;
      padding: 30px;
      margin-bottom: 30px;
      overflow-x: auto;
    }

    svg {
      display: block;
      margin: 0 auto;
      background: #19121a;
      border-radius: 12px;
      box-shadow: 0 2px 10px rgba(255, 121, 198, 0.11);
      min-width: 100%;
    }

    .legend {
      background: #2a1e28;
      border: 2px solid #ff79c6;
      border-radius: 12px;
      padding: 25px;
      margin-top: 10px;
    }

    .legend h3 {
      color: #ff79c6;
      margin-bottom: 20px;
      border-bottom: 2px solid #ff79c6;
      padding-bottom: 10px;
    }

    .legend-item {
      display: flex;
      align-items: center;
      gap: 15px;
      margin: 10px 0;
      color: #ffb3de;
      font-size: 0.95em;
    }

    .legend-color {
      width: 20px;
      height: 20px;
      border-radius: 50%;
      flex-shrink: 0;
    }

    .color-input  { background: #ff79c6; }
    .color-conv   { background: #50fa7b; }
    .color-pool   { background: #8be9fd; }
    .color-flatten{ background: #bd93f9; }
    .color-output { background: #fff52e; }

    .stats {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 20px;
      margin-top: 30px;
    }

    .stat-card {
      background: #19121a;
      border-left: 4px solid #50fa7b;
      padding: 20px;
      border-radius: 8px;
    }

    .stat-card.highlight {
      border-left-color: #fff52e;
    }

    .stat-label {
      color: #ffb3de;
      font-size: 0.9em;
      margin-bottom: 10px;
    }

    .stat-value {
      color: #fff52e;
      font-size: 1.8em;
      font-weight: bold;
      font-family: 'Courier New', monospace;
    }

    .dataset-info {
      margin-top: 20px;
      background: #19121a;
      border-radius: 8px;
      padding: 15px;
      line-height: 1.6;
      font-size: 0.9em;
      border-left: 4px solid #ff79c6;
    }

    .dataset-info strong {
      color: #fff52e;
    }

    @media (max-width: 768px) {
      .controls {
        flex-direction: column;
      }
    }
  </style>
</head>
<body>

<div class="container">
  <h1>ðŸ§  CIFAR-10 CNN Architecture</h1>
  <p class="subtitle">
    32Ã—32 RGB images (3 channels) â†’ Convolution + Pooling â†’ Fully Connected â†’ 10 CIFAR-10 Classes
  </p>

  <!-- CIFAR-10 introduction (kept text) -->
  <div class="cifar-intro">
    <strong>What is CIFAR-10?</strong><br>
    CIFAR-10 is a classic benchmark dataset in computer vision. It contains
    <strong>60,000 small color images (32Ã—32 pixels with 3 RGB channels)</strong> divided into
    <strong>10 everyday object categories</strong> such as airplane, automobile, bird, cat, deer, dog, frog, horse, ship, and truck.
    In our PyTorch demo, we train a <strong>CNN model</strong> that takes a 32Ã—32Ã—3 image and predicts which of these 10 classes it belongs to.
  </div>

  <!-- High-level description (kept text) -->
  <div class="controls">
    <div class="control-group">
      <label>CNN Input (for CIFAR-10)</label>
      <span>32 Ã— 32 Ã— 3 RGB image from CIFAR-10.</span>
    </div>
    <div class="control-group">
      <label>CNN Architecture (PyTorch Demo)</label>
      <span>Conv1 (5Ã—5, 16 filters) â†’ ReLU â†’ MaxPool (2Ã—2)</span>
      <span>Conv2 (5Ã—5, 32 filters) â†’ ReLU â†’ MaxPool (2Ã—2)</span>
      <span>Flatten â†’ Fully Connected â†’ Softmax (10 classes)</span>
    </div>
  </div>

  <!-- CNN architecture diagram -->
  <div class="network-container">
    <svg id="cnnSVG" width="1200" height="380" viewBox="0 0 1200 380"></svg>
  </div>

  <!-- Parameter breakdown -->
  <div class="stats" id="stats"></div>

  <!-- Legend + layer-by-layer flow (kept text) -->
  <div class="legend">
    <div class="dataset-info">
      <strong>CIFAR-10 Dataset Summary:</strong><br>
      â€¢ 60,000 color images at 32Ã—32 resolution (50,000 train / 10,000 test).<br>
      â€¢ 3 channels per pixel (R, G, B) â‡’ 32 Ã— 32 Ã— 3 = 3,072 numbers per image.<br>
      â€¢ 10 classes: airplane, automobile, bird, cat, deer, dog, frog, horse, ship, truck.<br>
      â€¢ The architecture diagram above corresponds to our PyTorch CNN:
        Conv â†’ ReLU â†’ MaxPool â†’ Conv â†’ ReLU â†’ MaxPool â†’ Flatten â†’ Fully Connected â†’ Softmax.
    </div>
  </div>
</div>

<script>
function drawCNN() {
  const svg = document.getElementById('cnnSVG');
  svg.innerHTML = '';

  const w = 1200;
  const h = 380;
  const centerY = h / 2;

  // Layer definitions (for visualization)
  const layers = [
    {
      name: 'Input Image',
      shape: '32Ã—32Ã—3',
      desc: 'RGB',
      type: 'input'
    },
    {
      name: 'Conv Layer 1',
      shape: '28Ã—28Ã—16',
      desc: 'Conv (5Ã—5, 16) + ReLU',
      type: 'conv'
    },
    {
      name: 'Pool Layer 1',
      shape: '14Ã—14Ã—16',
      desc: 'MaxPool (2Ã—2)',
      type: 'pool'
    },
    {
      name: 'Conv Layer 2',
      shape: '10Ã—10Ã—32',
      desc: 'Conv (5Ã—5, 32) + ReLU',
      type: 'conv'
    },
    {
      name: 'Pool Layer 2',
      shape: '5Ã—5Ã—32',
      desc: 'MaxPool (2Ã—2)',
      type: 'pool'
    },
    {
      name: 'Flatten + FC',
      shape: '800 â†’ 10',
      desc: 'Flatten + Fully Connected + Softmax',
      type: 'output'
    }
  ];

  const paddingX = 90;
  const availableW = w - 2 * paddingX;
  const stepX = availableW / (layers.length - 1);
  const rectW = 170;
  const rectH = 80;

  function getFillColor(type) {
    if (type === 'input') return '#ff79c6';
    if (type === 'conv') return '#50fa7b';
    if (type === 'pool') return '#8be9fd';
    if (type === 'output') return '#fff52e';
    return '#ffb3de';
  }

  function getStrokeColor(type) {
    if (type === 'output') return '#ff79c6';
    return '#222025';
  }

  // Draw arrows between layers first
  for (let i = 0; i < layers.length - 1; i++) {
    const x1 = paddingX + i * stepX + rectW / 2;
    const x2 = paddingX + (i + 1) * stepX - rectW / 2;
    const y = centerY;

    const line = document.createElementNS('http://www.w3.org/2000/svg', 'line');
    line.setAttribute('x1', x1 + rectW / 2);
    line.setAttribute('y1', y);
    line.setAttribute('x2', x2 - rectW / 2 + 10);
    line.setAttribute('y2', y);
    line.setAttribute('stroke', '#ffb3de');
    line.setAttribute('stroke-width', '2');
    line.setAttribute('marker-end', 'url(#arrowhead)');
    svg.appendChild(line);
  }

  // Add arrowhead marker definition
  const defs = document.createElementNS('http://www.w3.org/2000/svg', 'defs');
  const marker = document.createElementNS('http://www.w3.org/2000/svg', 'marker');
  marker.setAttribute('id', 'arrowhead');
  marker.setAttribute('markerWidth', '10');
  marker.setAttribute('markerHeight', '7');
  marker.setAttribute('refX', '0');
  marker.setAttribute('refY', '3.5');
  marker.setAttribute('orient', 'auto');
  const polygon = document.createElementNS('http://www.w3.org/2000/svg', 'polygon');
  polygon.setAttribute('points', '0 0, 10 3.5, 0 7');
  polygon.setAttribute('fill', '#ffb3de');
  marker.appendChild(polygon);
  defs.appendChild(marker);
  svg.appendChild(defs);

  // Draw layer rectangles + text
  layers.forEach((layer, i) => {
    const centerX = paddingX + i * stepX;
    const x = centerX - rectW / 2;
    const y = centerY - rectH / 2;

    const rect = document.createElementNS('http://www.w3.org/2000/svg', 'rect');
    rect.setAttribute('x', x);
    rect.setAttribute('y', y);
    rect.setAttribute('rx', 16);
    rect.setAttribute('ry', 16);
    rect.setAttribute('width', rectW);
    rect.setAttribute('height', rectH);
    rect.setAttribute('fill', getFillColor(layer.type));
    rect.setAttribute('stroke', getStrokeColor(layer.type));
    rect.setAttribute('stroke-width', '3');
    svg.appendChild(rect);

    // Layer name
    const nameText = document.createElementNS('http://www.w3.org/2000/svg', 'text');
    nameText.setAttribute('x', centerX);
    nameText.setAttribute('y', y + 26);
    nameText.setAttribute('text-anchor', 'middle');
    nameText.setAttribute('font-size', '14');
    nameText.setAttribute('font-weight', 'bold');
    nameText.setAttribute('fill', '#1a1d1f');
    nameText.textContent = layer.name;
    svg.appendChild(nameText);

    // Shape
    const shapeText = document.createElementNS('http://www.w3.org/2000/svg', 'text');
    shapeText.setAttribute('x', centerX);
    shapeText.setAttribute('y', y + 48);
    shapeText.setAttribute('text-anchor', 'middle');
    shapeText.setAttribute('font-size', '13');
    shapeText.setAttribute('fill', '#1a1d1f');
    shapeText.textContent = layer.shape;
    svg.appendChild(shapeText);

    // Description
    const descText = document.createElementNS('http://www.w3.org/2000/svg', 'text');
    descText.setAttribute('x', centerX);
    descText.setAttribute('y', y + 66);
    descText.setAttribute('text-anchor', 'middle');
    descText.setAttribute('font-size', '11');
    descText.setAttribute('fill', '#1a1d1f');
    descText.textContent = layer.desc;
    svg.appendChild(descText);
  });

  // Title inside SVG
  const title = document.createElementNS('http://www.w3.org/2000/svg', 'text');
  title.setAttribute('x', w / 2);
  title.setAttribute('y', 30);
  title.setAttribute('text-anchor', 'middle');
  title.setAttribute('font-size', '18');
  title.setAttribute('font-weight', 'bold');
  title.setAttribute('fill', '#ff79c6');
  title.textContent = 'CIFAR-10 CNN Forward Pass';
  svg.appendChild(title);
}

function updateStats() {
  // Architecture constants
  const inH = 32, inW = 32, inC = 3;
  const k = 5;
  const conv1Out = 16;
  const conv2Out = 32;
  const pool = 2;
  const numClasses = 10;

  // Conv1 params: (k*k*inC + bias) * outC
  const conv1Weights = k * k * inC * conv1Out;
  const conv1Biases = conv1Out;
  const conv1Total = conv1Weights + conv1Biases;

  // Conv2 params: (k*k*conv1Out + bias) * outC
  const conv2Weights = k * k * conv1Out * conv2Out;
  const conv2Biases = conv2Out;
  const conv2Total = conv2Weights + conv2Biases;

  // Spatial sizes:
  // After Conv1: 28Ã—28Ã—16
  // After Pool1: 14Ã—14Ã—16
  // After Conv2: 10Ã—10Ã—32
  // After Pool2: 5Ã—5Ã—32 â†’ 800 features
  const flattenSize = 5 * 5 * conv2Out; // 800

  // Fully connected params
  const fcWeights = flattenSize * numClasses;
  const fcBiases = numClasses;
  const fcTotal = fcWeights + fcBiases;

  const totalParams = conv1Total + conv2Total + fcTotal;

  const statsDiv = document.getElementById('stats');
  statsDiv.innerHTML = `
    <div class="stat-card">
      <div class="stat-label">Conv Layer 1 Parameters (Input 32Ã—32Ã—3 â†’ 28Ã—28Ã—16)</div>
      <div class="stat-value">${conv1Total.toLocaleString()}</div>
      <div style="color: #ffb3de; font-size: 0.85em; margin-top: 8px;">
        Weights: ${conv1Weights.toLocaleString()} &nbsp;|&nbsp; Biases: ${conv1Biases}
        <br>(5Ã—5Ã—3 per filter, 16 filters)
      </div>
    </div>

    <div class="stat-card">
      <div class="stat-label">Conv Layer 2 Parameters (14Ã—14Ã—16 â†’ 10Ã—10Ã—32)</div>
      <div class="stat-value">${conv2Total.toLocaleString()}</div>
      <div style="color: #ffb3de; font-size: 0.85em; margin-top: 8px;">
        Weights: ${conv2Weights.toLocaleString()} &nbsp;|&nbsp; Biases: ${conv2Biases}
        <br>(5Ã—5Ã—16 per filter, 32 filters)
      </div>
    </div>

    <div class="stat-card">
      <div class="stat-label">Fully Connected Layer Parameters (Flatten 800 â†’ 10)</div>
      <div class="stat-value">${fcTotal.toLocaleString()}</div>
      <div style="color: #ffb3de; font-size: 0.85em; margin-top: 8px;">
        Weights: ${fcWeights.toLocaleString()} &nbsp;|&nbsp; Biases: ${fcBiases}
      </div>
    </div>

    <div class="stat-card highlight">
      <div class="stat-label">Total Trainable Parameters</div>
      <div class="stat-value">${totalParams.toLocaleString()}</div>
      <div style="color: #ffb3de; font-size: 0.85em; margin-top: 8px;">
        Conv1 + Conv2 + Fully Connected (Softmax)
      </div>
    </div>
  `;
}

// Initialize on page load
window.addEventListener('load', () => {
  drawCNN();
  updateStats();
});
</script>

</body>
</html>
