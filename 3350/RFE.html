<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Chapter 2: Data Preprocessing & Feature Engineering</title>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
  <style>
   body {
      font-family: 'Roboto', Arial, sans-serif;
      margin: 0;
      background: #17191a;
      min-height: 100vh;
      color: #ff79c6;
      padding: 20px;
    }

    section {
      margin-bottom: 55px;
      background: #222025;
      border-radius: 18px;
      box-shadow: 0 4px 30px rgba(255,121,198,.09);
      padding: 36px 32px 22px 32px;
      transition: box-shadow .24s;
      border-left: 7px solid #ff79c6;
      position: relative;
      max-width: 850px;
      margin-left: auto;
      margin-right: auto;
    }

    section h4 {
      font-size: 1.18em;
      color: #ffb3de;
      margin-bottom: 5px;
      margin-top: 30px;
      font-weight: 600;
      border-bottom: 1px solid #ffb3de;
      padding-bottom: 2px;
    }

    pre {
      background: #19121a;
      color: #ffb3de;
      padding: 15px 18px;
      border-radius: 8px;
      font-size: 1.04em;
      line-height: 1.7;
      overflow-x: auto;
      box-shadow: 0 2px 10px rgba(255,121,198,0.11);
      position: relative;
    }

    pre .copy {
      position: absolute;
      top: 8px;
      right: 8px;
      padding: 4px 8px;
      background: #21111b;
      border: 1px solid #ff79c6;
      border-radius: 6px;
      color: #ffb3de;
      font-size: 0.8em;
      cursor: pointer;
    }
    pre .copy:hover {
      background: #ff79c6;
      color: #fff;
    }

    .note {
      margin-top: 30px;
      font-size: 0.95em;
      background: #19121a;
      padding: 18px;
      border-left: 5px solid #ff79c6;
      border-radius: 10px;
      color: #ffcce8;
      line-height: 1.6;
    }
  </style>
</head>
  
<body>

<section>
  <h4>Recursive Feature Elimination (RFE) – Feature Selection with Logistic Regression</h4>
  <p>
    Recursive Feature Elimination (RFE) is a wrapper method for feature selection. 
    It repeatedly trains a model, ranks features by importance, and removes the least important ones 
    until the desired number of features remains. Here we apply RFE to the Breast Cancer dataset.
  </p>

  <h4>Example: Logistic Regression with and without RFE</h4>
  <pre> <button class="copy">Copy</button> <code>
import pandas as pd
from sklearn.datasets import load_breast_cancer
from sklearn.linear_model import LogisticRegression
from sklearn.feature_selection import RFE
from sklearn.model_selection import train_test_split
from sklearn.metrics import accuracy_score

# --- Load dataset ---
cancer = load_breast_cancer(as_frame=True)
X = cancer.data
y = cancer.target

# --- Train-test split ---
X_train, X_test, y_train, y_test = train_test_split(
    X, y, test_size=0.2, random_state=42, stratify=y
)

# --- Baseline: Logistic Regression with all features ---
baseline_model = LogisticRegression(max_iter=5000, solver="liblinear")
baseline_model.fit(X_train, y_train)
y_pred_base = baseline_model.predict(X_test)
baseline_acc = accuracy_score(y_test, y_pred_base)

# --- Apply RFE to select top 10 features ---
rfe = RFE(estimator=LogisticRegression(max_iter=5000, solver="liblinear"), n_features_to_select=10)
X_train_rfe = rfe.fit_transform(X_train, y_train)
X_test_rfe = rfe.transform(X_test)

# Train Logistic Regression with reduced features
rfe_model = LogisticRegression(max_iter=5000, solver="liblinear")
rfe_model.fit(X_train_rfe, y_train)
y_pred_rfe = rfe_model.predict(X_test_rfe)
rfe_acc = accuracy_score(y_test, y_pred_rfe)

# --- Compare results ---
print("Logistic Regression with ALL features accuracy: {:.4f}".format(baseline_acc))
print("Logistic Regression with RFE-selected features accuracy: {:.4f}".format(rfe_acc))

# Show selected features
selected_features = X.columns[rfe.support_]
print("\nSelected Features by RFE:")
print(selected_features.tolist())
  </code> </pre>

  <h4>Notes:</h4>
  <ul>
    <li>The Breast Cancer dataset has many features that are <strong>redundant or highly correlated</strong> 
      (e.g., <code>mean radius</code>, <code>perimeter</code>, and <code>area</code> are all strongly correlated).</li>
    <li>Logistic Regression performs just as well with only 10 carefully chosen features because those 10 
      already capture most of the signal.</li>
    <li>RFE helps us see which features are the most informative and can safely drop the rest 
      without losing accuracy.</li>
  </ul>
    

  <h4><strong>Other models you can use with RFE</strong></h4>

    <ul>
      <li>Any estimator with either:
        <ul>
          <li><code>.coef_</code> (coefficients) — examples:
            <ul>
              <li>Linear Regression (<code>LinearRegression</code>)</li>
              <li>Logistic Regression (<code>LogisticRegression</code>)</li>
              <li>Linear SVM (<code>SVC(kernel="linear")</code> or <code>LinearSVC</code>)</li>
              <li>Ridge / Lasso / Elastic Net (<code>Ridge</code>, <code>Lasso</code>, <code>ElasticNet</code>)</li>
            </ul>
          </li>
          <li><code>.feature_importances_</code> — examples:
            <ul>
              <li>Decision Tree (<code>DecisionTreeClassifier</code> / <code>DecisionTreeRegressor</code>)</li>
              <li>Random Forest (<code>RandomForestClassifier</code> / <code>RandomForestRegressor</code>)</li>
              <li>Gradient Boosting (<code>GradientBoostingClassifier</code> / <code>GradientBoostingRegressor</code>)</li>
            </ul>
          </li>
        </ul>
      </li>
    </ul>


  
</section>

<script>
  document.querySelectorAll("pre .copy").forEach(button => {
    button.addEventListener("click", () => {
      const code = button.nextElementSibling.innerText;
      navigator.clipboard.writeText(code).then(() => {
        const old = button.textContent;
        button.textContent = "Copied!";
        setTimeout(() => button.textContent = old, 1500);
      });
    });
  });
</script>

</body>
</html>
