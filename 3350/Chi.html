
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Chapter 2: Data Preprocessing & Feature Engineering</title>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
  <style>
   body {
      font-family: 'Roboto', Arial, sans-serif;
      margin: 0;
      background: #17191a;
      min-height: 100vh;
      color: #ff79c6;
      padding: 20px;
    }

    section {
      margin-bottom: 55px;
      background: #222025;
      border-radius: 18px;
      box-shadow: 0 4px 30px rgba(255,121,198,.09);
      padding: 36px 32px 22px 32px;
      transition: box-shadow .24s;
      border-left: 7px solid #ff79c6;
      position: relative;
      max-width: 850px;
      margin-left: auto;
      margin-right: auto;
    }

    section h4 {
      font-size: 1.18em;
      color: #ffb3de;
      margin-bottom: 5px;
      margin-top: 30px;
      font-weight: 600;
      border-bottom: 1px solid #ffb3de;
      padding-bottom: 2px;
    }

    pre {
      background: #19121a;
      color: #ffb3de;
      padding: 15px 18px;
      border-radius: 8px;
      font-size: 1.04em;
      line-height: 1.7;
      overflow-x: auto;
      box-shadow: 0 2px 10px rgba(255,121,198,0.11);
      position: relative;
    }

    pre .copy {
      position: absolute;
      top: 8px;
      right: 8px;
      padding: 4px 8px;
      background: #21111b;
      border: 1px solid #ff79c6;
      border-radius: 6px;
      color: #ffb3de;
      font-size: 0.8em;
      cursor: pointer;
    }
    pre .copy:hover {
      background: #ff79c6;
      color: #fff;
    }
  </style>
</head>
  
<body>

<section>
  <h4>Chi-Square Test – Measuring Categorical Feature Importance</h4>
  <p>
    The <strong>Chi-Square test (χ²)</strong> is used to measure the relationship between 
    a <em>categorical feature</em> and a <em>categorical target variable</em>. 
    It checks whether the observed distribution of values differs significantly from what would be expected if they were independent.
  </p>

  <h4>Example: Chi-Square Feature Selection</h4>
  <pre> <button class="copy">Copy</button> <code>
import pandas as pd
from sklearn.datasets import load_breast_cancer
from sklearn.preprocessing import KBinsDiscretizer
from sklearn.feature_selection import chi2, SelectKBest

# --- Load dataset ---
cancer = load_breast_cancer(as_frame=True)
X = cancer.data
y = cancer.target   # 0 = malignant, 1 = benign

print("Original Data (first 5 rows):")
print(X.head())

# --- Discretize continuous features ---
# The Chi-Square test is designed for categorical (count-based, non-negative integer) data.
# Many machine learning datasets have continuous numerical features (like area, radius, concavity in your cancer dataset).
# To apply Chi-Square, we need to convert continuous values into discrete categories (bins).
discretizer = KBinsDiscretizer(n_bins=5, encode="ordinal", strategy="uniform")
X_binned = pd.DataFrame(discretizer.fit_transform(X), columns=X.columns)

print("\nBinned Features (for Chi-Square):")
print(X_binned.head())

# --- Apply Chi-Square test ---
chi_scores, p_values = chi2(X_binned, y)

print("\nChi-Square Scores and p-values:")
for feature, score, p in sorted(zip(X.columns, chi_scores, p_values), key=lambda x: x[1], reverse=True)[:10]:
    print(f"{feature}: Chi2 = {score:.2f}, p-value = {p:.4e}")

# --- Select top k features ---
selector = SelectKBest(chi2, k=5)
X_new = selector.fit_transform(X_binned, y)
print("\nShape of reduced dataset:", X_new.shape)

# Get selected feature names
selected_features = X.columns[selector.get_support()]
print("\nTop 5 selected features:")
print(selected_features.tolist())
  </code> </pre>

  <h4>Notes:</h4>
  <ul>
    <li>Used only for <strong>categorical features</strong> (after encoding to numeric form).</li>
    <li>A <code>p-value &lt; 0.05</code> means the feature and target are likely dependent (useful for prediction).</li>
    <li>Chi-Square requires non-negative values, so apply to counts or one-hot encoded features only.</li>
  
  </ul>

  <ul>
  <li>
    <strong>The Chi-Square test (χ²)</strong> works on <em>categorical / count-based data</em>.
  </li>
  <li>
    Our dataset features are <strong>continuous</strong> (e.g., <code>radius = 17.99</code>, <code>texture = 10.38</code>).<br>
    Chi² doesn’t make sense directly on raw floats.
  </li>
  <li>
    <strong>Solution:</strong> Use <code>KBinsDiscretizer</code> to cut continuous values into bins:
    <ul>
      <li><code>n_bins=5</code>: Each feature is divided into 5 intervals (very low → very high).</li>
      <li><code>encode="ordinal"</code>: Assigns bin numbers <code>0,1,2,3,4</code>.</li>
      <li><code>strategy="uniform"</code>: Bins are equally spaced.</li>
    </ul>
  </li>
</ul>

  
</section>

<script>
  document.querySelectorAll("pre .copy").forEach(button => {
    button.addEventListener("click", () => {
      const code = button.nextElementSibling.innerText;
      navigator.clipboard.writeText(code).then(() => {
        const old = button.textContent;
        button.textContent = "Copied!";
        setTimeout(() => button.textContent = old, 1500);
      });
    });
  });
</script>

</body>
</html>
