<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>MLP Training Pipeline - PyTorch Digits</title>
  <style>
    body {
      margin: 0;
      padding: 20px;
      background: #1a1d1f;
      font-family: 'Roboto', Arial, sans-serif;
      color: #ffb3de;
    }

    .container {
      max-width: 1400px;
      margin: 0 auto;
      background: #222025;
      border-radius: 18px;
      padding: 40px;
      box-shadow: 0 4px 30px rgba(255,121,198,.09);
      border-left: 7px solid #ff79c6;
    }

    h1 {
      color: #ff79c6;
      text-align: center;
      margin-top: 0;
      font-size: 2.2em;
      margin-bottom: 10px;
    }

    .subtitle {
      color: #ffb3de;
      text-align: center;
      margin-bottom: 30px;
      font-size: 1.1em;
    }

    svg {
      display: block;
      margin: 40px auto;
      background: #19121a;
      border-radius: 12px;
      box-shadow: 0 2px 10px rgba(255,121,198,0.11);
      padding: 20px;
    }

    .pipeline-section {
      background: #2a1e28;
      border: 2px solid #ff79c6;
      border-radius: 12px;
      padding: 25px;
      margin-top: 30px;
    }

    .pipeline-section h3 {
      color: #ff79c6;
      margin-top: 0;
      border-bottom: 2px solid #ff79c6;
      padding-bottom: 10px;
      margin-bottom: 15px;
    }

    .pipeline-step {
      background: #19121a;
      border-left: 4px solid #50fa7b;
      padding: 15px;
      margin: 12px 0;
      border-radius: 8px;
    }

    .step-number {
      color: #fff52e;
      font-weight: bold;
      font-size: 1.1em;
      margin-bottom: 5px;
    }

    .step-content {
      color: #ffb3de;
      line-height: 1.6;
    }

    .step-code {
      background: #0a0a0a;
      padding: 10px;
      border-radius: 6px;
      font-family: 'Courier New', monospace;
      color: #fff52e;
      margin-top: 10px;
      font-size: 0.9em;
      overflow-x: auto;
    }

    .legend {
      background: #2a1e28;
      border: 2px solid #ff79c6;
      border-radius: 12px;
      padding: 25px;
      margin-top: 30px;
    }

    .legend h3 {
      color: #ff79c6;
      margin-top: 0;
      border-bottom: 2px solid #ff79c6;
      padding-bottom: 10px;
    }

    .legend-item {
      display: flex;
      align-items: flex-start;
      gap: 15px;
      margin: 12px 0;
      color: #ffb3de;
    }

    .legend-color {
      width: 20px;
      height: 20px;
      border-radius: 50%;
      flex-shrink: 0;
      margin-top: 2px;
    }

    .color-data { background: #50fa7b; }
    .color-model { background: #ff79c6; }
    .color-train { background: #fff52e; }
    .color-eval { background: #ffb3de; }
    .color-output { background: #8be9fd; }

    .key-points {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 20px;
      margin-top: 20px;
    }

    .key-point {
      background: #19121a;
      border-left: 4px solid #50fa7b;
      padding: 15px;
      border-radius: 8px;
    }

    .key-point-title {
      color: #ff79c6;
      font-weight: bold;
      margin-bottom: 8px;
    }

    .key-point-text {
      color: #ffb3de;
      font-size: 0.95em;
      line-height: 1.5;
    }

    .pipeline-flow {
      background: #19121a;
      padding: 20px;
      border-radius: 8px;
      margin-top: 15px;
      color: #fff52e;
      font-family: 'Courier New', monospace;
      line-height: 2;
      text-align: center;
    }
  </style>
</head>
<body>

<div class="container">

  <h1>üß† Full MLP Training Pipeline</h1>
  <p class="subtitle">Complete workflow for PyTorch MLP on scikit-learn Digits Dataset</p>

  <svg width="1800" height="800" viewBox="0 0 1800 800" style="width:100%; max-width:1800px">
    <!-- Title -->
    <text x="900" y="40" font-size="26" font-weight="bold" fill="#ff79c6" text-anchor="middle">
      The Complete Training Pipeline
    </text>

    <!-- Stage 1: Data Loading -->
    <rect x="80" y="90" width="300" height="150" fill="#2a1e28" stroke="#50fa7b" stroke-width="3" rx="10"/>
    <text x="230" y="130" font-size="20" font-weight="bold" fill="#50fa7b" text-anchor="middle">üìä Load Data</text>
    <text x="230" y="160" font-size="15" fill="#ffb3de" text-anchor="middle">1,797 samples</text>
    <text x="230" y="180" font-size="15" fill="#ffb3de" text-anchor="middle">64 features (8√ó8)</text>
    <text x="230" y="200" font-size="15" fill="#ffb3de" text-anchor="middle">10 classes (0‚Äì9)</text>

    <!-- Arrow 1 -->
    <path d="M 380 165 L 430 165" stroke="#fff52e" stroke-width="4" fill="none" marker-end="url(#arrowhead)"/>

    <!-- Stage 2: Preprocess -->
    <rect x="430" y="90" width="300" height="150" fill="#2a1e28" stroke="#50fa7b" stroke-width="3" rx="10"/>
    <text x="580" y="130" font-size="20" font-weight="bold" fill="#50fa7b" text-anchor="middle">‚öôÔ∏è Preprocess</text>
    <text x="580" y="160" font-size="15" fill="#ffb3de" text-anchor="middle">Train/Test Split</text>
    <text x="580" y="180" font-size="15" fill="#ffb3de" text-anchor="middle">Standardize</text>
    <text x="580" y="200" font-size="15" fill="#ffb3de" text-anchor="middle">Batchify</text>

    <!-- Arrow 2 -->
    <path d="M 730 165 L 780 165" stroke="#fff52e" stroke-width="4" fill="none" marker-end="url(#arrowhead)"/>

    <!-- Stage 3: Model Setup -->
    <rect x="780" y="90" width="300" height="150" fill="#2a1e28" stroke="#ff79c6" stroke-width="3" rx="10"/>
    <text x="930" y="130" font-size="20" font-weight="bold" fill="#ff79c6" text-anchor="middle">üîß Initialize Model</text>
    <text x="930" y="160" font-size="15" fill="#ffb3de" text-anchor="middle">MLP: 64‚Üí64‚Üí32‚Üí10</text>
    <text x="930" y="180" font-size="15" fill="#ffb3de" text-anchor="middle">6,570 parameters</text>
    <text x="930" y="200" font-size="15" fill="#ffb3de" text-anchor="middle">Adam optimizer</text>

    <!-- Arrow 3 -->
    <path d="M 1080 165 L 1130 165" stroke="#fff52e" stroke-width="4" fill="none" marker-end="url(#arrowhead)"/>

    <!-- Stage 4: Training -->
    <rect x="1130" y="90" width="300" height="150" fill="#2a1e28" stroke="#fff52e" stroke-width="4" rx="10"/>
    <text x="1280" y="130" font-size="20" font-weight="bold" fill="#fff52e" text-anchor="middle">üöÄ TRAINING LOOP</text>
    <text x="1280" y="160" font-size="15" fill="#ffb3de" text-anchor="middle">50 epochs</text>
    <text x="1280" y="180" font-size="15" fill="#ffb3de" text-anchor="middle">~23 batches/epoch</text>
    <text x="1280" y="200" font-size="15" fill="#ffb3de" text-anchor="middle">Update weights</text>

    <!-- Arrow 4 -->
    <path d="M 1430 165 L 1480 165" stroke="#fff52e" stroke-width="4" fill="none" marker-end="url(#arrowhead)"/>

    <!-- Stage 5: Evaluation -->
    <rect x="1480" y="90" width="300" height="150" fill="#2a1e28" stroke="#8be9fd" stroke-width="3" rx="10"/>
    <text x="1630" y="130" font-size="20" font-weight="bold" fill="#8be9fd" text-anchor="middle">‚úÖ Evaluation</text>
    <text x="1630" y="160" font-size="15" fill="#ffb3de" text-anchor="middle">360 test samples</text>
    <text x="1630" y="180" font-size="15" fill="#ffb3de" text-anchor="middle">Accuracy / F1</text>

    <!-- Arrow marker -->
    <defs>
      <marker id="arrowhead" markerWidth="14" markerHeight="10" refX="10" refY="5" orient="auto">
        <polygon points="0 0, 14 5, 0 10" fill="#fff52e" />
      </marker>
    </defs>


    <!-- TRAINING LOOP (bigger, with arrows & reduced height) -->
    <g id="training-loop">

      <!-- Outer training-loop box -->
      <rect x="80" y="300" width="1700" height="280"
            fill="#2a1e28" stroke="#ff79c6" stroke-width="4" rx="10"/>

      <text x="120" y="335" font-size="22" font-weight="bold" fill="#fff52e">
        FOR epoch = 1 TO 50:
      </text>

      <!-- Inner loop box (reduced height: was 240 ‚Üí now 180) -->
      <rect x="120" y="360" width="1620" height="180"
            fill="#19121a" stroke="#50fa7b" stroke-width="3" rx="8"/>

      <text x="150" y="395" font-size="20" font-weight="bold" fill="#50fa7b">
        FOR batch = 1 TO 23:
      </text>

      <!-- STEP 1 -->
      <circle cx="250" cy="460" r="35" fill="#fff52e" stroke="#ff79c6" stroke-width="3"/>
      <text x="250" y="468" font-size="22" font-weight="bold" fill="#1a1d1f" text-anchor="middle">1</text>
      <text x="250" y="500" font-size="14" fill="#ffb3de" text-anchor="middle">Zero Grad</text>

      <!-- Arrow 1‚Üí2 -->
      <path d="M 285 460 L 350 460" stroke="#fff52e" stroke-width="4"
            fill="none" marker-end="url(#arrowhead)"/>

      <!-- STEP 2 -->
      <circle cx="400" cy="460" r="35" fill="#50fa7b" stroke="#ff79c6" stroke-width="3"/>
      <text x="400" y="468" font-size="22" font-weight="bold" fill="#1a1d1f" text-anchor="middle">2</text>
      <text x="400" y="500" font-size="14" fill="#ffb3de" text-anchor="middle">Forward</text>

      <!-- Arrow 2‚Üí3 -->
      <path d="M 435 460 L 500 460" stroke="#fff52e" stroke-width="4"
            fill="none" marker-end="url(#arrowhead)"/>

      <!-- STEP 3 -->
      <circle cx="550" cy="460" r="35" fill="#ffb3de" stroke="#ff79c6" stroke-width="3"/>
      <text x="550" y="468" font-size="22" font-weight="bold" fill="#1a1d1f" text-anchor="middle">3</text>
      <text x="550" y="500" font-size="14" fill="#ffb3de" text-anchor="middle">Loss</text>

      <!-- Arrow 3‚Üí4 -->
      <path d="M 585 460 L 650 460" stroke="#fff52e" stroke-width="4"
            fill="none" marker-end="url(#arrowhead)"/>

      <!-- STEP 4 -->
      <circle cx="700" cy="460" r="35" fill="#ff79c6" stroke="#ffb3de" stroke-width="3"/>
      <text x="700" y="468" font-size="22" font-weight="bold" fill="#1a1d1f" text-anchor="middle">4</text>
      <text x="700" y="500" font-size="14" fill="#ffb3de" text-anchor="middle">Backward</text>

      <!-- Arrow 4‚Üí5 -->
      <path d="M 735 460 L 800 460" stroke="#fff52e" stroke-width="4"
            fill="none" marker-end="url(#arrowhead)"/>

      <!-- STEP 5 -->
      <circle cx="850" cy="460" r="35" fill="#8be9fd" stroke="#ff79c6" stroke-width="3"/>
      <text x="850" y="468" font-size="22" font-weight="bold" fill="#1a1d1f" text-anchor="middle">5</text>
      <text x="850" y="500" font-size="14" fill="#ffb3de" text-anchor="middle">Update</text>

    </g>


    <!-- Example Timeline (bigger) -->
    <rect x="80" y="670" width="1700" height="200" fill="#19121a" stroke="#ffb3de" stroke-width="3" rx="10"/>
    <text x="930" y="705" font-size="22" font-weight="bold" fill="#ffb3de" text-anchor="middle">üìä Example Training Timeline</text>

    <text x="120" y="750" font-size="18" fill="#50fa7b" font-weight="bold">Epoch 1:</text>
    <text x="250" y="750" font-size="17" fill="#ffb3de">Batch 1 ‚Üí ... ‚Üí B23 ‚Üí Avg Loss = 2.302</text>

    <text x="120" y="785" font-size="18" fill="#50fa7b" font-weight="bold">Epoch 2:</text>
    <text x="250" y="785" font-size="17" fill="#ffb3de">Batch 1 ‚Üí ... ‚Üí B23 ‚Üí Avg Loss = 1.950</text>

    <text x="120" y="820" font-size="18" fill="#50fa7b" font-weight="bold">Epoch 50:</text>
    <text x="250" y="820" font-size="17" fill="#ffb3de">Batch 1 ‚Üí ... ‚Üí B23 ‚Üí Avg Loss = 0.015</text>
  </svg>
</div>

<div class="pipeline-section" style="margin-top: 25px;">
  <h3>üìò Example: Macro Avg vs Weighted Avg</h3>

  <!-- Example Table -->
  <div class="key-point" style="margin-bottom: 20px;">
    <div class="key-point-title">Example Dataset</div>
    <div class="key-point-text">
      Consider a 3-class classification problem with the following results:
      <br><br>
      <table style="width:100%; border-collapse: collapse; color:#ffb3de; font-size: 0.95em;">
        <tr style="border-bottom: 1px solid #ff79c6;">
          <th style="padding: 8px; text-align:left;">Class</th>
          <th style="padding: 8px; text-align:left;"># Samples</th>
          <th style="padding: 8px; text-align:left;">F1-score</th>
        </tr>
        <tr>
          <td style="padding: 8px;">A</td>
          <td style="padding: 8px;">90</td>
          <td style="padding: 8px;">0.90</td>
        </tr>
        <tr>
          <td style="padding: 8px;">B</td>
          <td style="padding: 8px;">9</td>
          <td style="padding: 8px;">0.00</td>
        </tr>
        <tr>
          <td style="padding: 8px;">C</td>
          <td style="padding: 8px;">1</td>
          <td style="padding: 8px;">1.00</td>
        </tr>
      </table>
    </div>
  </div>

  <!-- Macro Average -->
  <div class="key-point">
    <div class="key-point-title">Macro Average</div>
    <div class="key-point-text">
      Macro average computes the metric <b>independently for each class</b> and
      then takes the <b>simple average</b> across all classes:
      <br><br>
      <code style="color:#fff52e;">Macro F1 = (0.90 + 0.00 + 1.00) / 3 = 0.633</code>
      <br><br>
      ‚úî Each class contributes equally<br>
      ‚úî Good for measuring minority class performance<br>
      ‚úò Does not consider class imbalance
    </div>
  </div>

  <!-- Weighted Average -->
  <div class="key-point" style="margin-top: 15px;">
    <div class="key-point-title">Weighted Average</div>
    <div class="key-point-text">
      Weighted average computes the metric for each class and then takes an
      average <b>weighted by the number of true samples</b> in each class:
      <br><br>
      <code style="color:#fff52e;">
        Weighted F1 = (0.90 √ó 90 + 0.00 √ó 9 + 1.00 √ó 1) / 100 = 0.82
      </code>
      <br><br>
      ‚úî Large classes dominate the metric<br>
      ‚úî Better reflects overall accuracy on imbalanced datasets<br>
      ‚úò Small classes affect the score very little
    </div>
  </div>

</div>


</div>

</body>
</html>
