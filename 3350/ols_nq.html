<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Worked Example: House Price — OLS via Normal Equation (NumPy)</title>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
  <style>
   body {
      font-family: 'Roboto', Arial, sans-serif;
      margin: 0;
      background: #17191a;
      min-height: 100vh;
      color: #ff79c6;
      padding: 20px;
    }

    section {
      margin-bottom: 55px;
      background: #222025;
      border-radius: 18px;
      box-shadow: 0 4px 30px rgba(255,121,198,.09);
      padding: 36px 32px 22px 32px;
      transition: box-shadow .24s;
      border-left: 7px solid #ff79c6;
      position: relative;
      max-width: 850px;
      margin-left: auto;
      margin-right: auto;
    }

    h2 {
      margin: 0 0 10px 0;
      color: #ffb3de;
      font-weight: 700;
    }

    section h4 {
      font-size: 1.18em;
      color: #ffb3de;
      margin-bottom: 5px;
      margin-top: 30px;
      font-weight: 600;
      border-bottom: 1px solid #ffb3de;
      padding-bottom: 2px;
    }

    a.anchor {
      text-decoration: none;
      margin-left: .5rem;
      opacity: .6;
      color: #ffb3de;
    }
    a.anchor:hover { opacity: 1; }

    pre {
      background: #19121a;
      color: #ffb3de;
      padding: 15px 18px;
      border-radius: 8px;
      font-size: 1.04em;
      line-height: 1.7;
      overflow-x: auto;
      box-shadow: 0 2px 10px rgba(255,121,198,0.11);
      position: relative;
    }

    pre .copy {
      position: absolute;
      top: 8px;
      right: 8px;
      padding: 4px 8px;
      background: #21111b;
      border: 1px solid #ff79c6;
      border-radius: 6px;
      color: #ffb3de;
      font-size: 0.8em;
      cursor: pointer;
    }
    pre .copy:hover {
      background: #ff79c6;
      color: #fff;
    }

    ul.toc {
      padding-left: 18px;
      margin-top: 8px;
    }
    ul.toc li { margin: 4px 0; }
    ul.toc a { color: #ffb3de; }
  </style>
</head>

<body>

<section>
  <h2>Worked Example: Predicting House Price — Method 1: OLS via Normal Equation</h2>
  <p>
    This page provides a single, copy-ready Python script that:
    (1) constructs \(X\) and \(y\), (2) solves \(\hat\beta=(X^\top X)^{-1}X^\top y\),
    (3) makes predictions, residuals, and (4) evaluates SSE, MSE, RMSE, and \(R^2\).
  </p>
  <p>
    Quick jumps:
  </p>
  <ul class="toc">
    <li><a href="#full-script">Full Python Script</a></li>
    <li><a href="#step-7" title="Jump to metrics block">Step 7: Metrics (SSE, MSE, RMSE, R²)</a></li>
  </ul>

  <h4 id="full-script">Full Python Script <a href="#full-script" class="anchor" aria-label="Direct link">¶</a></h4>
  <pre><button class="copy">Copy</button><code>
# ========================================================
# Worked Example: Predicting House Price
# Method 1: OLS via Normal Equation
# ========================================================
import numpy as np

# --------------------------------------------------------
# Step 1: Data 
# 1-D NumPy array with 5 elements
# --------------------------------------------------------
size = np.array([1000, 1500, 2000, 2500, 3000], dtype=float)
bed  = np.array([2, 3, 3, 4, 4], dtype=float)
price= np.array([200_000, 280_000, 340_000, 400_000, 460_000], dtype=float)

# --------------------------------------------------------
# Step 2: Build Matrices X and y
# builds your design matrix X by stacking 1-D arrays as columns
# X includes an intercept column of ones
# np.ones_like(A) returns a new NumPy array of ones that has the same shape and dtype as A
# --------------------------------------------------------
X = np.column_stack([np.ones_like(size), size, bed])  # shape (5, 3)
y = price.reshape(-1, 1)                              # shape (5, 1)

print("X =\n", X)
print("\ny =\n", y)

# --------------------------------------------------------
# Step 3: Compute X^T X and X^T y
# --------------------------------------------------------
# @ is Python’s matrix-multiplication operator 
# A @ B ≡ np.matmul(A, B) ≡ A.dot(B)
XtX = X.T @ X
Xty = X.T @ y
print("\nX^T X =\n", XtX)
print("\nX^T y =\n", Xty)

# --------------------------------------------------------
# Step 4: Solve the Normal Equation
# beta_hat = (X^T X)^{-1} X^T y
# np.linalg is NumPy’s linear algebra module
# --------------------------------------------------------
beta_hat = np.linalg.inv(XtX) @ Xty  # shape (3, 1)
beta0, beta1, beta2 = beta_hat.flatten()

print("\nEstimated coefficients (Normal Equation):")
print(f"  β0 (Intercept) = {beta0:.2f}")
print(f"  β1 (Size)      = {beta1:.2f}")
print(f"  β2 (Bedrooms)  = {beta2:.2f}")

# --------------------------------------------------------
# Step 5: Final Model (implicitly)
#   ŷ = X β_hat
# --------------------------------------------------------
y_hat = X @ beta_hat                 # shape (5, 1)
print("\nPredictions (Normal Equation) ŷ =\n", y_hat.flatten())

# --------------------------------------------------------
# Step 6: Residuals and Errors
# --------------------------------------------------------
residuals = y - y_hat
print("\nResiduals r = y - ŷ =\n", residuals.flatten())

# --------------------------------------------------------
# Step 7: Evaluation Metrics — SSE, MSE, RMSE, R^2
# --------------------------------------------------------
SSE = float(np.sum(residuals**2))
MSE = SSE / len(y)
RMSE = np.sqrt(MSE)

# R^2 (manual): 1 - SSE / TSS, where TSS = sum((y - ybar)^2)
y_mean = float(np.mean(y))
TSS = float(np.sum((y - y_mean)**2))
R2 = 1.0 - SSE / TSS

print("\n--- Metrics (Normal Equation) ---")
print(f"SSE  = {SSE:.2f}")
print(f"MSE  = {MSE:.2f}")
print(f"RMSE = {RMSE:.2f}")
print(f"R^2  = {R2:.4f}")
  </code></pre>

  <h4 id="step-7">Step 7: Metrics (SSE, MSE, RMSE, R²) <a href="#step-7" class="anchor" aria-label="Direct link">¶</a></h4>
  <p>Just the metrics block, in case students want to copy only this part:</p>
  <pre><button class="copy">Copy</button><code>
# --- Metrics (Normal Equation) ---
SSE = float(np.sum(residuals**2))
MSE = SSE / len(y)
RMSE = np.sqrt(MSE)

y_mean = float(np.mean(y))
TSS = float(np.sum((y - y_mean)**2))
R2 = 1.0 - SSE / TSS

print("\n--- Metrics (Normal Equation) ---")
print(f"SSE  = {SSE:.2f}")
print(f"MSE  = {MSE:.2f}")
print(f"RMSE = {RMSE:.2f}")
print(f"R^2  = {R2:.4f}")
  </code></pre>
</section>

<script>
  document.querySelectorAll("pre .copy").forEach(button => {
    button.addEventListener("click", () => {
      const code = button.nextElementSibling.innerText;
      navigator.clipboard.writeText(code).then(() => {
        const old = button.textContent;
        button.textContent = "Copied!";
        setTimeout(() => button.textContent = old, 1500);
      });
    });
  });
</script>

</body>
</html>

